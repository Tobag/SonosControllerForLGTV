'use strict';

var expect = require('chai').expect;
var rewire = require('rewire');

describe('MusicServices', function () {

  var musicServices;

  beforeEach(function () {

    musicServices = rewire('../../lib/musicservices');
  });

  it('should reject on non existent service', function () {
    return musicServices.tryGetHighResArt('sid=1000').then(function () {
      throw new Error('Should not resolve');
    }, function () {});
  });

  it('should return cover art on existing service', function () {
    var uri = 'x-sonos-http:track%3a44731098.mp3?sid=160&flags=8224&sn=10';
    return musicServices.tryGetHighResArt(uri).then(function (url) {
      expect(url).to.equal('https://i1.sndcdn.com/artworks-000022486019-txiq8s-t500x500.jpg');
    });
  });
});
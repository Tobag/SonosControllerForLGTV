'use strict';

var expect = require('chai').expect;
var sinon = require('sinon');
var proxyquire = require('proxyquire');
require('chai').use(require('sinon-chai'));

describe('getPlaylists', function () {

  var system = void 0;
  var resultMock = void 0;
  var success = void 0;

  var getPlaylists = require('../../../../lib/prototypes/SonosSystem/getPlaylists.js');

  describe('When calling getPlaylists', function () {
    var player = void 0;
    before(function () {

      resultMock = {
        items: [],
        startIndex: 0,
        numberReturned: 0,
        totalMatches: 0
      };

      player = {
        browseAll: sinon.stub().resolves(resultMock.items)
      };

      system = {
        getAnyPlayer: sinon.stub().returns(player)
      };

      success = sinon.spy();

      return getPlaylists.call(system).then(success);
    });

    it('Has called browseAll', function () {
      expect(player.browseAll).calledOnce;
      expect(player.browseAll.firstCall.args).eql(['SQ:']);
    });

    it('Returns the expected result', function () {
      expect(success.firstCall.args[0]).eql(resultMock.items);
    });
  });
});